<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>图片选择器插件</title>
</head>
<body>
<h1>图片选择器插件示例</h1>
图片链接<input type="text" id="url">
<button id="btn" type="button">选择</button>

<div id="frame" style="width:1000px; height:600px; border: 1px solid red;display: none;">
    <!-- TODO:弹出框 -->
</div>


<script type="text/javascript" src="/statics/jquery/jquery.min.js"></script>
<script>
    $(function () {
        $('#btn').on('click', (event) => {
            // TODO 开启选择框
            $('#frame').show();
            // ImagesManager(id, url, callback)
            ImagesManager('frame', '/', function (url) {
                // TODO: 将url写入编辑器文本框
                $('input#url').val(url);
                alert(url);
                // TUDO: 关闭选择框modal
                $('#frame').hide();
            });
        });
    });
    function ImagesManager(id, src, func) {
        const iframe = $('<iframe>').attr('src', src).css('width', '100%').css('height', '100%').css('border', 'none');
        $('#' + id).html(iframe);
        iframe.on('load', (event) => {
            // iframe加载完成
            const frame = $(event.currentTarget).contents();
            const images_wall = frame.find('#images-wall');
            images_wall.one('click', function () {
                // 图片墙已经加载
                const option = images_wall.find('.option').find('ul');
                option.append($('<li>').text('选择').addClass('choose').css('float', 'left'));
                option.find('.choose').on('click', (event) => {
                    const box = $(event.currentTarget).parents('section.box');
                    const image = box.find('img');
                    func(image.attr('data-original'));
                });
            });
        });
    }
</script>
</body>
</html>